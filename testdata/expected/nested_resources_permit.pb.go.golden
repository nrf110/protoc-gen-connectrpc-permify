package testv1

func (req *NestedRequest) GetChecks() pkg.CheckConfig {
    permission := "manage"
    var checks []pkg.Check
    resource := req.Organization
    tenantId := "default"
    if req.Organization.TenantId != "" {
        tenantId = req.Organization.TenantId
    }
    check := pkg.Check {
        TenantID:     tenantId,
        Permission:   permission,
        Entity: &pkg.Resource {
            Type:       "Organization",
            ID:        req.Organization.Id,
        },
    }
    checks = append(checks, check)
    for _, project := range req.Projects {
        resource := project
        tenantId := "default"
        check := pkg.Check {
            TenantID:     tenantId,
            Permission:   permission,
            Entity: &pkg.Resource {
                Type:       "Project",
                ID:        project.Id,
            },
        }
        checks = append(checks, check)
    }
    return pkg.CheckConfig {
        Type:   pkg.SINGLE,
        Checks: checks,
    }
}